<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Dynamic project test</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.4.0/build/cssgrids/grids-min.css">
    <script src="http://yui.yahooapis.com/3.4.0/build/yui/yui-min.js"></script>
    <script type="text/javascript" src="../../src/js-dependencies/webgl-debug.js"></script>
    <script type="text/javascript" src="../../src/js/constants.js"></script>
    <script type="text/javascript" src="../../src/js/glslconstants.js"></script>
    <script type="text/javascript" src="../../src/js/core.js"></script>
    <script type="text/javascript" src="../../src/js/resource.js"></script>
    <script type="text/javascript" src="../../src/js/math.js"></script>
    <script type="text/javascript" src="../../src/js/mesh.js"></script>
    <script type="text/javascript" src="../../src/js/scene.js"></script>
    <script type="text/javascript" src="../../src/js/renderer.js"></script>
    <script type="text/javascript" src="../../src/js/material.js"></script>
    <script type="text/javascript" src="../../src/js/meshfactory.js"></script>
    <script type="text/javascript" src="../../src/js/texture.js"></script>
    <style type="text/css">
        button{
            width:120px;
        }
    </style>
</head>
<body onload="initKick();">
<h1>Project and scene serialization test</h1>
<br>
<button onclick="showProjectJSON();">showProjectJSON</button>
<button onclick="showSceneJSON();">showSceneJSON</button><br>

<button onclick="addTexture();">addTexture</button>
<button onclick="addMesh();">addMesh</button>
<button onclick="addMaterial();">addMaterial</button>
<button onclick="addShader();">addShader</button>
<button onclick="addScene();">addScene</button><br>

<button onclick="removeTexture();">removeTexture</button>
<button onclick="removeMesh();">removeMesh</button>
<button onclick="removeMaterial();">removeMaterial</button>
<button onclick="removeShader();">removeShader</button>
<button onclick="removeScene();">removeScene</button><br>

<button onclick="listTextures();">listTextures</button>
<button onclick="listMeshes();">listMeshes</button>
<button onclick="listMaterials();">listMaterials</button>
<button onclick="listShaders();">listShaders</button>
<button onclick="listScenes();">listScenes</button><br>

  <canvas id="canvas" style="border: none;" width="300" height="300"></canvas> <br>

<textarea style="width:500px;height:500px;" id="txt">

</textarea>
<script type="text/javascript">
    "use strict";
        var engine;
        var meshRenderer;

        function initKick() {
            engine = new KICK.core.Engine('canvas',{
                enableDebugContext: true
            });
        }

        function showProjectJSON(){
            var jsonObj = engine.project.toJSON();
            document.getElementById("txt").value = JSON.stringify(jsonObj,null," ");
        }

        function showSceneJSON(){
            var jsonObj = engine.activeScene.toJSON();
            document.getElementById("txt").value = JSON.stringify(jsonObj,null," ");
        }

        function addTexture(){
            var texture = new KICK.texture.Texture(engine);
            texture.name = "Some Texture "+new Date().getTime();
            engine.resourceManager.getImageData("http://khm0.googleapis.com/kh?v=95&x=0&y=0&z=0",texture);
        }

        function addMesh(){
            var mesh;
            if (Math.random()<0.5){
                mesh = engine.resourceManager.getMesh("kickjs://mesh/cube/?length="+Math.random());
            } else {
                mesh = new KICK.mesh.Mesh(engine);
            }
            mesh.name = "Some Mesh "+new Date().getTime();
        }

        function addMaterial(){
            var material = new KICK.material.Material(engine);
            material.name = "Some material "+new Date().getTime();
        }

        function addShader(){
            var shader = new KICK.material.Shader(engine);
            shader.name = "Some shader "+new Date().getTime();
        }

        function addScene(){
            var shader = new KICK.scene.Scene(engine);
            shader.name = "Some scene "+new Date().getTime();
        }



        function removeByType(type){
            var project = engine.project;
            var resourceList = engine.project.getResourceDescriptorByType(type);
            if (resourceList.length>0){
                var resource = project.load(resourceList[0].uid);
                resource.destroy();
            }
        }

        function removeTexture(){
            removeByType("KICK.texture.Texture");
        }

        function removeMesh(){
            removeByType("KICK.mesh.Mesh");
        }

        function removeMaterial(){
            removeByType("KICK.material.Material");
        }

        function removeShader(){
            removeByType("KICK.material.Shader");
        }

        function removeScene(){
            removeByType("KICK.scene.Scene");
        }


        function listTypes(type){
            engine.project.refreshResourceDescriptors();
            var resourceList = engine.project.getResourceDescriptorByType(type);
            var str = "";
            for (var i=0;i<resourceList.length;i++){
                str += resourceList[i].name+" ("+resourceList[i].uid+")\n";
            }
            document.getElementById("txt").value = "List of "+type+":\n"+str;
        }

        function listTextures(){
            listTypes("KICK.texture.Texture");

        }

        function listMeshes(){
            listTypes("KICK.mesh.Mesh");
        }

        function listMaterials(){
            listTypes("KICK.material.Material");
        }

        function listShaders(){
            listTypes("KICK.material.Shader");
        }

        function listScenes(){
            listTypes("KICK.scene.Scene");
        }
</script>
</body>
</html>